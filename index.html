<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RBH-1: Runaway Supermassive Black Hole</title>
  <meta name="description" content="Interactive visualization of the first confirmed runaway supermassive black hole (Van Dokkum et al. 2026). Explore bow shock physics, position-velocity models, and planetary encounter scenarios.">

  <!-- Styles -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/panels.css">
  <link rel="stylesheet" href="css/controls.css">

  <!-- Three.js from CDN -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <h1><span class="accent">RBH-1</span> &mdash; <span id="title-text">Runaway Supermassive Black Hole</span></h1>
      <div class="velocity-readout">
        <span id="velocity-easy" class="easy-only" style="font-size:12px;color:#8888aa;">Speed: </span>
        <span class="complex-only">v = </span>
        <span class="value" id="velocity-value">954 km/s</span>
        <span id="velocity-human" class="easy-only" style="color:#ff8844;font-size:11px;margin-left:4px;">(2.1 million mph)</span>
        <span class="text-dim complex-only" id="velocity-frac">(0.32% c)</span>
        <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" class="paper-link" title="Van Dokkum et al. 2026, ApJL 998:L27">Paper</a>
        <div class="toggle-group mode-toggle" id="mode-toggle" style="margin-left:12px;">
          <button class="toggle-btn active" data-mode="easy">Easy</button>
          <button class="toggle-btn" data-mode="complex">Complex</button>
        </div>
      </div>
    </header>

    <!-- Intro splash (easy mode, shown on first load) -->
    <div id="intro-splash">
      <div class="splash-content">
        <div class="splash-title"><span class="accent">RBH-1</span></div>
        <div class="splash-subtitle">The First Runaway Supermassive Black Hole</div>
        <div class="splash-facts">
          <div class="splash-fact"><span class="fact-num">20,000,000&times;</span> <span class="fact-text">heavier than our Sun</span></div>
          <div class="splash-fact"><span class="fact-num">2.1 million mph</span> <span class="fact-text">hurtling through space</span></div>
          <div class="splash-fact"><span class="fact-num">200,000 light-years</span> <span class="fact-text">trail of newborn stars behind it</span></div>
          <div class="splash-fact"><span class="fact-num">Kicked out</span> <span class="fact-text">of its own galaxy by colliding black holes</span></div>
        </div>
        <button id="splash-enter" class="splash-btn" onclick="document.getElementById('intro-splash').classList.add('hidden');setTimeout(()=>document.getElementById('intro-splash').style.display='none',700)">Explore</button>
        <div class="splash-credit">Based on <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" style="color:var(--cyan);text-decoration:none;">Van Dokkum et al. 2026</a> &mdash; discovered with JWST</div>
      </div>
    </div>

    <!-- 3D Scene -->
    <div id="scene-container">
      <div class="frame-indicator" id="frame-label">BH Rest Frame</div>
      <div id="dashboard"></div>
      <!-- Easy-mode fun facts overlay -->
      <div id="fun-facts" class="easy-only" style="display:none;">
        <div class="fun-fact" id="fun-fact-text">This black hole is moving 300&times; faster than a bullet</div>
      </div>
    </div>

    <!-- Right Panel -->
    <div id="right-panel">
      <!-- Tabs -->
      <div class="tab-bar">
        <button class="tab-btn active" data-tab="tab-schematic" data-easy="How It Works" data-complex="Schematic">How It Works</button>
        <button class="tab-btn" data-tab="tab-planetview" data-easy="Your Sky" data-complex="Sky View">Your Sky</button>
        <button class="tab-btn" data-tab="tab-encounter" data-easy="What If?" data-complex="Encounter">What If?</button>
        <button class="tab-btn" data-tab="tab-pv" data-easy="Speed Map" data-complex="PV Diagram">Speed Map</button>
        <button class="tab-btn" data-tab="tab-wake" data-easy="The Trail" data-complex="Wake">The Trail</button>
      </div>

      <!-- Schematic Tab (now default/first) -->
      <div class="tab-content active" id="tab-schematic">
        <div class="plot-area" style="position:relative;">
          <canvas id="schematic-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:60px;left:16px;right:16px;">
            The black hole plows through thin gas between galaxies. The gas piles up in front like a boat's bow wave, then flows around and trails behind as a glowing wake.
          </div>
        </div>
        <div class="slider-panel" id="schematic-sliders">
          <h3 class="easy-only">Adjust the physics</h3>
          <h3 class="complex-only">Bow Shock Geometry</h3>
        </div>
      </div>

      <!-- Planet Sky View Tab -->
      <div class="tab-content" id="tab-planetview">
        <div class="plot-area" style="position:relative;">
          <canvas id="planetview-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            What would you see if you looked up at the night sky from a planet in its path? Drag the distance slider to watch it approach.
          </div>
        </div>
        <div class="slider-panel" id="planetview-sliders">
          <h3 class="easy-only">How far away is it?</h3>
          <h3 class="complex-only">Observer Distance</h3>
        </div>
      </div>

      <!-- Encounter Tab -->
      <div class="tab-content" id="tab-encounter">
        <div class="plot-area" style="position: relative;">
          <div id="encounter-info" class="encounter-info">
            <h4>PLANETARY ENCOUNTER</h4>
            <p>Adjust the timeline to see what happens when a 20 million solar mass black hole barrels through a solar system at 954 km/s.</p>
          </div>
          <canvas id="encounter-canvas" style="display:none;"></canvas>
        </div>
        <div class="slider-panel" id="encounter-sliders">
          <h3 class="easy-only">What happens to a solar system?</h3>
          <h3 class="complex-only">Encounter Parameters</h3>
        </div>
      </div>

      <!-- PV Diagram Tab -->
      <div class="tab-content" id="tab-pv">
        <div class="plot-area" style="position:relative;">
          <canvas id="pv-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            This shows how fast the gas is moving at different positions across the wake. The S-shaped curve is the model â€” orange dots are what the telescope actually measured.
          </div>
        </div>
        <div class="slider-panel" id="pv-sliders">
          <h3 class="easy-only">Change the model</h3>
          <h3 class="complex-only">PV Model Parameters (Eq 1-8)</h3>
        </div>
      </div>

      <!-- Wake Profile Tab -->
      <div class="tab-content" id="tab-wake">
        <div class="plot-area" style="position:relative;">
          <canvas id="wake-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            The wake gets faster the closer you get to the black hole. Near the galaxy (left), things are calm. Near the BH (right), gas is moving at 300 km/s.
          </div>
        </div>
        <div class="slider-panel" id="wake-sliders">
          <h3 class="easy-only">Wake speed curve</h3>
          <h3 class="complex-only">Wake Model (Eq 19) &amp; Shock (Eq 13)</h3>
        </div>
      </div>
    </div>

    <!-- Toolbar -->
    <div id="toolbar">
      <div class="toolbar-group complex-only" id="frame-toggle">
        <span class="toolbar-label">Frame:</span>
        <div class="toggle-group">
          <button class="toggle-btn active" data-frame="bh">BH</button>
          <button class="toggle-btn" data-frame="cgm">CGM</button>
        </div>
      </div>

      <div class="toolbar-sep complex-only"></div>

      <div class="toolbar-group">
        <span class="toolbar-label">Speed:</span>
        <input type="range" class="toolbar-slider" id="speed-slider" min="0" max="3" step="0.1" value="1">
      </div>

      <div class="toolbar-sep complex-only"></div>

      <label class="checkbox-toggle complex-only">
        <input type="checkbox" id="vectors-toggle">
        <span>Vectors</span>
      </label>

      <div style="flex:1;"></div>

      <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" class="paper-link-footer mono" style="font-size:10px;">
        Van Dokkum et al. 2026, ApJL 998:L27
      </a>
    </div>
  </div>

  <!-- App Bootstrap -->
  <script type="module">
    import { init } from './js/app.js';
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
