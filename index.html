<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RBH-1: Runaway Supermassive Black Hole</title>
  <meta name="description" content="Interactive visualization of the first confirmed runaway supermassive black hole (Van Dokkum et al. 2026). Explore bow shock physics, position-velocity models, and planetary encounter scenarios.">

  <!-- Styles -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/panels.css">
  <link rel="stylesheet" href="css/controls.css">

  <!-- Three.js from CDN -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <h1><span class="accent">RBH-1</span> &mdash; <span id="title-text">Runaway Supermassive Black Hole</span></h1>
      <div class="velocity-readout">
        <span id="velocity-easy" class="easy-only" style="font-size:12px;color:#8888aa;">Speed: </span>
        <span class="complex-only">v = </span>
        <span class="value" id="velocity-value">954 km/s</span>
        <span id="velocity-human" class="easy-only" style="color:#ff8844;font-size:11px;margin-left:4px;">(2.1 million mph)</span>
        <span class="text-dim complex-only" id="velocity-frac">(0.32% c)</span>
        <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" class="paper-link" title="Van Dokkum et al. 2026, ApJL 998:L27">Paper</a>
        <div class="toggle-group mode-toggle" id="mode-toggle" style="margin-left:12px;" aria-label="Difficulty mode">
          <button class="toggle-btn active" data-mode="easy" aria-label="Easy mode - plain language">Easy</button>
          <button class="toggle-btn" data-mode="complex" aria-label="Complex mode - full physics">Pro</button>
        </div>
      </div>
    </header>

    <!-- Intro splash (shown on first load) -->
    <div id="intro-splash">
      <div class="splash-content">
        <div class="splash-title"><span class="accent">RBH-1</span></div>
        <div class="splash-subtitle">The First Runaway Supermassive Black Hole</div>
        <div class="splash-tagline">A black hole so massive it was ejected from its own galaxy &mdash; and now it's tearing through space, leaving a trail of newborn stars in its wake.</div>
        <div class="splash-facts">
          <div class="splash-fact"><span class="fact-num">20 million</span> <span class="fact-text">times heavier than our Sun</span></div>
          <div class="splash-fact"><span class="fact-num">2.1 million mph</span> <span class="fact-text">hurtling through intergalactic space</span></div>
          <div class="splash-fact"><span class="fact-num">200,000 light-years</span> <span class="fact-text">trail of newborn stars behind it</span></div>
          <div class="splash-fact"><span class="fact-num">Kicked out</span> <span class="fact-text">by three colliding black holes in its galaxy</span></div>
        </div>
        <div class="splash-buttons">
          <button id="splash-enter" class="splash-btn" onclick="document.getElementById('intro-splash').classList.add('hidden');setTimeout(()=>document.getElementById('intro-splash').style.display='none',700)">Explore the Simulation</button>
        </div>
        <div class="splash-credit">Based on <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" style="color:var(--cyan);text-decoration:none;">Van Dokkum et al. 2026</a> &mdash; confirmed by the James Webb Space Telescope</div>
      </div>
    </div>

    <!-- 3D Scene -->
    <div id="scene-container">
      <div class="frame-indicator" id="frame-label">BH Rest Frame</div>
      <div id="dashboard"></div>
      <!-- Easy-mode fun facts overlay -->
      <div id="fun-facts" class="easy-only" style="display:none;">
        <div class="fun-fact" id="fun-fact-text">This black hole is moving 300&times; faster than a bullet</div>
      </div>
    </div>

    <!-- Right Panel -->
    <div id="right-panel">
      <!-- Tabs -->
      <div class="tab-bar" role="tablist" aria-label="Visualization panels">
        <button class="tab-btn active" role="tab" aria-selected="true" data-tab="tab-schematic" data-easy="1. How It Works" data-complex="Schematic" data-index="0">1. How It Works</button>
        <button class="tab-btn" role="tab" aria-selected="false" data-tab="tab-planetview" data-easy="2. Your Sky" data-complex="Sky View" data-index="1">2. Your Sky</button>
        <button class="tab-btn" role="tab" aria-selected="false" data-tab="tab-encounter" data-easy="3. What If?" data-complex="Encounter" data-index="2">3. What If?</button>
        <button class="tab-btn" role="tab" aria-selected="false" data-tab="tab-pv" data-easy="4. Speed Map" data-complex="PV Diagram" data-index="3">4. Speed Map</button>
        <button class="tab-btn" role="tab" aria-selected="false" data-tab="tab-wake" data-easy="5. The Trail" data-complex="Wake" data-index="4">5. The Trail</button>
      </div>

      <!-- Schematic Tab (now default/first) -->
      <div class="tab-content active" id="tab-schematic">
        <div class="plot-area" style="position:relative;">
          <canvas id="schematic-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:60px;left:16px;right:16px;">
            <strong>The bow wave.</strong> Imagine a speedboat on a lake. The black hole is the boat, and the thin gas between galaxies is the water. Gas piles up in front, flows around the sides, and trails behind as a glowing wake of newborn stars.
          </div>
        </div>
        <div class="slider-panel" id="schematic-sliders">
          <h3 class="easy-only">Play with the physics</h3>
          <h3 class="complex-only">Bow Shock Geometry</h3>
        </div>
        <div class="tab-nav easy-only">
          <span class="tab-nav-hint">Start here! Drag the sliders to see how the shape changes</span>
          <button class="tab-nav-btn tab-nav-next" data-dir="next">Your Sky &rarr;</button>
        </div>
      </div>

      <!-- Planet Sky View Tab -->
      <div class="tab-content" id="tab-planetview">
        <div class="plot-area" style="position:relative;">
          <canvas id="planetview-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            <strong>Your last night sky.</strong> Imagine standing on a planet right in its path. At first you'd see a strange blue smudge. Then the sky starts to warp as gravity bends starlight. Hit "Watch It Approach" to see the end.
          </div>
        </div>
        <div class="slider-panel" id="planetview-sliders">
          <h3 class="easy-only">How far away is it?</h3>
          <h3 class="complex-only">Observer Distance</h3>
        </div>
        <div class="tab-nav easy-only">
          <button class="tab-nav-btn tab-nav-prev" data-dir="prev">&larr; How It Works</button>
          <button class="tab-nav-btn tab-nav-next" data-dir="next">What If? &rarr;</button>
        </div>
      </div>

      <!-- Encounter Tab -->
      <div class="tab-content" id="tab-encounter">
        <div class="plot-area" style="position: relative;">
          <canvas id="encounter-canvas"></canvas>
          <div id="encounter-info" class="encounter-info">
            <h4 class="complex-only">PLANETARY ENCOUNTER</h4>
            <h4 class="easy-only">WHAT HAPPENS TO A SOLAR SYSTEM?</h4>
            <p class="complex-only">Adjust the timeline to see what happens when a 20 million solar mass black hole barrels through a solar system at 954 km/s.</p>
            <p class="easy-only">This black hole weighs 20 million suns and moves at 2.1 million mph. Drag the timeline below to watch it tear through a solar system.</p>
          </div>
        </div>
        <div class="slider-panel" id="encounter-sliders">
          <h3 class="easy-only">What happens to a solar system?</h3>
          <h3 class="complex-only">Encounter Parameters</h3>
        </div>
        <div class="tab-nav easy-only">
          <button class="tab-nav-btn tab-nav-prev" data-dir="prev">&larr; Your Sky</button>
          <button class="tab-nav-btn tab-nav-next" data-dir="next">Speed Map &rarr;</button>
        </div>
      </div>

      <!-- PV Diagram Tab -->
      <div class="tab-content" id="tab-pv">
        <div class="plot-area" style="position:relative;">
          <canvas id="pv-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            <strong>Matching real data.</strong> The orange dots are real measurements from JWST. The blue curve is our mathematical model. Try adjusting the sliders until the curve passes through the dots — that's how scientists figure out how fast the black hole is actually moving!
          </div>
        </div>
        <div class="slider-panel" id="pv-sliders">
          <h3 class="easy-only">Try to match the real data!</h3>
          <h3 class="complex-only">PV Model Parameters (Eq 1-8)</h3>
        </div>
        <div class="tab-nav easy-only">
          <button class="tab-nav-btn tab-nav-prev" data-dir="prev">&larr; What If?</button>
          <button class="tab-nav-btn tab-nav-next" data-dir="next">The Trail &rarr;</button>
        </div>
      </div>

      <!-- Wake Profile Tab -->
      <div class="tab-content" id="tab-wake">
        <div class="plot-area" style="position:relative;">
          <canvas id="wake-canvas"></canvas>
          <div class="easy-annotation easy-only" style="position:absolute;bottom:10px;left:16px;right:16px;">
            <strong>The 200,000 light-year trail.</strong> The wake gets faster the closer you get to the black hole. Near the galaxy (left side), things are calm. Close to the BH (right side), gas screams along at 300 km/s — faster than anything in our solar system.
          </div>
        </div>
        <div class="slider-panel" id="wake-sliders">
          <h3 class="easy-only">How fast is the trail moving?</h3>
          <h3 class="complex-only">Wake Model (Eq 19) &amp; Shock (Eq 13)</h3>
        </div>
        <div class="tab-nav easy-only">
          <button class="tab-nav-btn tab-nav-prev" data-dir="prev">&larr; Speed Map</button>
          <span class="tab-nav-hint">You've explored everything! Switch to Complex mode for the full physics.</span>
        </div>
      </div>
    </div>

    <!-- Toolbar -->
    <div id="toolbar">
      <div class="toolbar-group">
        <span class="toolbar-label easy-only">Animation:</span>
        <span class="toolbar-label complex-only">Speed:</span>
        <input type="range" class="toolbar-slider" id="speed-slider" min="0" max="3" step="0.1" value="1" aria-label="Animation speed">
        <span class="toolbar-speed-label" id="speed-label">1x</span>
      </div>

      <div style="flex:1;"></div>

      <a href="https://arxiv.org/abs/2302.04888" target="_blank" rel="noopener" class="paper-link-footer mono" style="font-size:10px;">
        Van Dokkum et al. 2026, ApJL 998:L27
      </a>
    </div>
  </div>

  <!-- App Bootstrap -->
  <script type="module">
    import { init } from './js/app.js';
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
